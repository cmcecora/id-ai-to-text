# App Flow Document

## Onboarding and Sign-In/Sign-Up
A brand-new user arrives at the application by navigating to the company landing page or following a direct link to the enterprise portal. On the landing page, the user sees options to sign in or create a new account. To sign up, the user clicks the “Create Account” button, enters their email address, chooses a password, and confirms the password. After submitting, the system sends an email verification link. Once the user clicks the verification link, they are redirected back to the sign-in screen and can log in with their new credentials. If the user forgets their password at any point, they click the “Forgot Password?” link on the sign-in page, enter their email address, receive a password reset email, and follow the link to define a new password. After signing in successfully, a session is established via Laravel Passport, setting an authorization token in the browser. Users can sign out by clicking the profile avatar in the header and selecting “Log Out.”

## Main Dashboard or Home Page
After logging in, the user lands on the Main Dashboard. The header contains the company logo on the left, a search field in the center, and the user avatar on the right. A vertical sidebar on the left lists navigation items such as Dashboard, Profile, Notifications, and Identity Documents. The central content area shows summary widgets by default, but when the user selects “Identity Documents” from the sidebar, the main panel loads the dedicated two-panel upload interface. At any time, the user can switch between sections by clicking the corresponding sidebar item, with the active section highlighted.

## Detailed Feature Flows and Page Transitions
When the user clicks “Identity Documents,” the app transitions to the upload page. This page uses a two-panel layout. On the left, the Upload Panel invites the user to drag and drop or browse to select a single JPG, PNG, PDF, HEIC, or native phone image file up to 10 MB. If the file is unsupported or exceeds the size limit, an inline error message appears beneath the file input explaining the problem and preventing further steps. Once a valid file is chosen, the panel immediately compresses images larger than a client-side threshold via ngx-image-compress and then renders a preview. For images, the photo displays directly; for PDFs, ng2-pdf-viewer shows only the first page. A small note confirms that only the first page will be processed. The “Upload” button then becomes active.

Upon clicking “Upload,” the interface disables file inputs and displays a spinner overlay on the preview. An Angular service sends the file to the secured endpoint `/api/documents/upload` using HttpClient with the Passport token. The backend saves the file temporarily, uses heic-convert to convert HEIC to JPEG if needed, and then enqueues an OCR job with Laravel queue workers. Meanwhile, the frontend polls `/api/documents/status/{jobId}` every few seconds to track progress. If connectivity is lost, the polling pauses and a snackbar alerts the user, then resumes once the connection returns.

When the OCR worker finishes, the frontend receives a structured JSON payload containing LastName, FirstName, MiddleInitial, AddressStreet, AddressCity, AddressState, AddressZip, Sex, and DOB. At that moment, the Data Form panel on the right transitions from disabled to enabled. Each input is pre-filled with the extracted value. Inline validation immediately highlights any fields that do not conform to rules—alphabetic names, single-letter middle initial, two-letter state codes, ZIP code patterns, allowed sex values, and a non-future date in MM-DD-YYYY format. A snackbar message announces that OCR has completed and invites the user to review the form.

The user edits any incorrect values directly in the form. As soon as every field meets validation requirements, the “Save” button activates. The user can also navigate away and return later; until they click “Save,” the data remains in draft. When the user clicks “Save,” the Data Form disables, and a loading spinner appears within the form area. An Angular service issues a POST to `/api/documents/{documentId}` to persist the data in MongoDB via the Laravel API. Upon successful save, a snackbar confirms “Identity information saved.” The form then locks, switching to read-only mode, and an “Edit” button appears below the form.

If the user clicks “Edit,” the form unlocks, enabling the inputs and swapping the “Edit” button back to “Save.” This toggle cycle can repeat indefinitely, allowing the user to correct or update their identity information. When the user revisits the Identity Documents page in the future, the application detects the existing document record, fetches the stored JPEG preview via the `/uploads` static route, and populates the Data Form in locked mode. The user clicks “Edit” to make changes, triggering the same save workflow.

## Settings and Account Management
The user can manage personal information and preferences by clicking their avatar in the header and selecting “Settings.” This navigates to a settings page where the user sees tabs for Profile, Security, and Notifications. In the Profile tab, the user updates their name and email. In the Security tab, they change their password by entering the current password, new password, and confirmation. Inline validation ensures the new password meets complexity rules. In the Notifications tab, the user toggles email notifications on or off. After making changes, clicking “Save” on each tab triggers immediate updates via the secured API and displays a snackbar on success. A “Back to Dashboard” link at the top returns the user to the main dashboard or the last visited section, such as Identity Documents.

## Error States and Alternate Paths
If the user attempts to upload an unsupported file type or a file over 10 MB, the Upload Panel displays an inline error message and the “Upload” button remains disabled. During the compression, upload, or OCR steps, any HTTP failures surface as Angular Material snackbars with a human-friendly message like “Upload failed. Please try again.” The snackbar may include a “Retry” action. If the OCR job times out or fails server-side, the Upload Panel shows an error banner and presents a “Reprocess Document” button. If the user loses network connectivity during polling, the loader pauses and a snackbar informs them of offline mode until reconnection. Attempting to access the Identity Documents page without an active session redirects the user to the sign-in page. Any undefined routes in the application show a standard 404 page with navigation options to return to the dashboard.

## Conclusion and Overall App Journey
From the moment a user signs up and logs in, they can navigate to the Identity Documents page via the sidebar. There they select a single image or PDF of their ID, preview it, and upload for AI-powered OCR processing. The system converts HEIC files, compresses large images, and runs extraction on the first page only. Extracted fields appear in a two-panel layout where the user reviews, edits, and validates each field before saving. Once saved, the data locks until the user chooses to edit again. Throughout the flow, clear loading states, inline errors, and snackbars guide the user, ensuring they can complete the identity upload task reliably. The feature integrates seamlessly into the larger application, supports future enhancements such as SMS-based uploads, and delivers a consistent experience from initial sign-up through everyday use of identity document management.